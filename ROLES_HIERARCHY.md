# Jerarqu√≠a de Roles del Sistema - Paucara

## Estructura de Roles

Este documento describe la jerarqu√≠a de roles implementada en el sistema de distribuidora Paucara, basada en Laravel Spatie Permission.

---

## Nivel 1: Super Admin üîê

**Descripci√≥n:** Acceso total al sistema. Es el rol de m√°s alto nivel.

**Caracter√≠sticas:**
- ‚úÖ Acceso completo a todas las funcionalidades
- ‚úÖ √önico rol que puede crear otros Super Admins
- ‚úÖ Manejo de configuraciones cr√≠ticas del sistema (`admin.system`)
- ‚úÖ Soporte t√©cnico y resoluci√≥n de errores del sistema
- ‚úÖ Gesti√≥n total de permisos y roles
- ‚úÖ Puede eliminar usuarios y realizar acciones irreversibles

**Casos de uso:**
- Desarrolladores del sistema
- Personal de soporte t√©cnico
- Propietarios del negocio con conocimientos t√©cnicos

**Comando para crear:**
```bash
php artisan admin:create-super-admin
```

---

## Nivel 2: Admin / Manager

### Admin üë®‚Äçüíº

**Descripci√≥n:** Administrador con casi todos los permisos del sistema.

**Caracter√≠sticas:**
- ‚úÖ Casi todos los permisos (excepto `admin.system`)
- ‚ùå NO puede crear Super Admins
- ‚ùå NO puede acceder a configuraciones cr√≠ticas del sistema
- ‚úÖ Puede gestionar empleados, clientes, productos, ventas, compras
- ‚úÖ Acceso a reportes y configuraciones del negocio
- ‚úÖ Puede crear y gestionar usuarios normales

**Casos de uso:**
- Gerente general
- Administrador del negocio sin conocimientos t√©cnicos
- Personal de confianza con responsabilidad administrativa

---

### Manager üìä

**Descripci√≥n:** Gesti√≥n operativa completa del negocio.

**Permisos incluidos:**

#### Operaciones Completas:
- **Ventas:** Crear, editar, eliminar, ver proformas, verificar stock
- **Compras:** Gesti√≥n completa de compras, pagos y cuentas por pagar
- **Inventario:** Dashboard, ajustes, transferencias, mermas, veh√≠culos
- **Log√≠stica:** Env√≠os, seguimiento, asignaci√≥n de choferes
- **Cajas:** Abrir, cerrar, consultar movimientos
- **Contabilidad:** Ver asientos, libro mayor, balance de comprobaci√≥n

#### Gesti√≥n de Personal:
- ‚úÖ Crear, editar, actualizar empleados
- ‚úÖ Cambiar estados de empleados
- ‚úÖ Gestionar acceso al sistema de empleados

#### Gesti√≥n de Usuarios (Limitada):
- ‚úÖ Ver, crear, editar usuarios
- ‚úÖ Asignar/remover roles a usuarios
- ‚ùå NO puede eliminar usuarios
- ‚ùå NO puede gestionar Super Admins

#### Maestros del Sistema:
- ‚úÖ Gesti√≥n completa de: Categor√≠as, Marcas, Almacenes, Proveedores, Clientes, Productos, Unidades, Tipos de precio, Tipos de pago, Monedas

#### Reportes:
- ‚úÖ Todos los reportes disponibles (precios, ganancias, inventario, etc.)

#### Configuraci√≥n:
- ‚úÖ Configuraci√≥n general del negocio (`admin.config`)
- ‚úÖ M√≥dulos del sidebar
- ‚ùå NO configuraciones cr√≠ticas del sistema (`admin.system`)

**Casos de uso:**
- Gerente de operaciones
- Administrador operativo
- Encargado general del negocio

---

## Nivel 3: Roles Departamentales/Funcionales

### Gerente üìà

**Permisos:** Supervisi√≥n y reportes ejecutivos

- ‚úÖ Ver ventas, compras, inventario (solo lectura)
- ‚úÖ Ver empleados y su informaci√≥n
- ‚úÖ Acceso completo a reportes
- ‚úÖ Configuraci√≥n de m√°rgenes de ganancia

**Uso:** Roles de supervisi√≥n sin capacidad de modificaci√≥n

---

### Vendedor üí∞

**Permisos:** Gesti√≥n de ventas

- ‚úÖ Crear, editar, eliminar ventas
- ‚úÖ Gestionar proformas (crear, aprobar, convertir a venta)
- ‚úÖ Verificar stock de productos
- ‚úÖ Gestionar clientes
- ‚úÖ Ver cat√°logo de productos

**Uso:** Personal de ventas en mostrador o campo

---

### Comprador / Compras üõí

**Permisos:** Gesti√≥n de compras y proveedores

- ‚úÖ Crear, editar compras
- ‚úÖ Gestionar cuentas por pagar
- ‚úÖ Registrar pagos a proveedores
- ‚úÖ Gestionar lotes y vencimientos
- ‚úÖ Gestionar proveedores
- ‚úÖ Reportes de precios y compras

**Uso:** Personal encargado de compras e inventario de entrada

---

### Gestor de Almac√©n üì¶

**Permisos:** Control de inventario f√≠sico

- ‚úÖ Dashboard de inventario
- ‚úÖ Ajustes de inventario
- ‚úÖ Transferencias entre almacenes (crear, enviar, recibir)
- ‚úÖ Registrar y gestionar mermas
- ‚úÖ Gestionar almacenes
- ‚úÖ Reportes de stock, vencimientos, movimientos

**Uso:** Almacenistas, encargados de bodega

---

### Cajero üíµ

**Permisos:** Operaci√≥n de caja

- ‚úÖ Abrir y cerrar caja
- ‚úÖ Crear ventas directas
- ‚úÖ Ver movimientos de caja
- ‚úÖ Gestionar clientes b√°sicos

**Uso:** Personal de caja, punto de venta

---

### Chofer üöö

**Permisos:** Gesti√≥n de entregas

- ‚úÖ Ver env√≠os asignados
- ‚úÖ Ver seguimiento de entregas
- ‚úÖ Dashboard de log√≠stica
- ‚úÖ Registrar clientes durante entregas
- ‚úÖ Ver su perfil de empleado

**Uso:** Choferes, repartidores

---

### Inventario üìä

**Permisos:** Control de stock especializado

- ‚úÖ Dashboard y reportes de inventario
- ‚úÖ Ajustes de stock
- ‚úÖ Gesti√≥n de mermas (registrar, aprobar/rechazar)
- ‚úÖ Transferencias entre almacenes
- ‚úÖ Gesti√≥n de productos y almacenes

**Uso:** Personal especializado en control de inventario

---

### Log√≠stica üöõ

**Permisos:** Coordinaci√≥n de env√≠os

- ‚úÖ Crear, programar, cancelar env√≠os
- ‚úÖ Confirmar entregas y salidas
- ‚úÖ Ver choferes y veh√≠culos disponibles
- ‚úÖ Dashboard de log√≠stica
- ‚úÖ Seguimiento de env√≠os

**Uso:** Coordinadores de log√≠stica y distribuci√≥n

---

### Contabilidad üíº

**Permisos:** Reportes contables y financieros

- ‚úÖ Ver asientos contables
- ‚úÖ Libro mayor
- ‚úÖ Balance de comprobaci√≥n
- ‚úÖ Gesti√≥n contable general

**Uso:** Personal del √°rea contable

---

### Reportes üìä

**Permisos:** Acceso a reporter√≠a completa

- ‚úÖ Reportes de precios y exportaci√≥n
- ‚úÖ Reportes de ganancias
- ‚úÖ Reportes de inventario (stock, vencimientos, rotaci√≥n, movimientos)

**Uso:** Analistas, personal de reporter√≠a

---

## Nivel 4: Roles de Acceso Limitado

### Empleado üë§

**Permisos:** Acceso m√≠nimo

- ‚úÖ Ver su propio perfil de empleado
- ‚ùå Sin acceso a otras funcionalidades

**Uso:** Empleados sin rol espec√≠fico asignado, empleados base

---

### Cliente üõçÔ∏è

**Permisos:** Acceso externo limitado

- ‚úÖ Gestionar su propio perfil
- ‚ùå Sin acceso a funcionalidades internas

**Uso:** Clientes con acceso al portal (si aplica)

---

## Comparativa R√°pida

| Rol | Puede crear usuarios | Puede eliminar | Acceso config sistema | Gesti√≥n completa |
|-----|---------------------|----------------|----------------------|------------------|
| **Super Admin** | ‚úÖ Incluso Super Admins | ‚úÖ Todo | ‚úÖ Total | ‚úÖ Total |
| **Admin** | ‚úÖ Usuarios normales | ‚úÖ Usuarios normales | ‚ùå | ‚úÖ Casi todo |
| **Manager** | ‚úÖ Limitado | ‚ùå | ‚ùå | ‚úÖ Operacional |
| **Gerente** | ‚ùå | ‚ùå | ‚ùå | üëÅÔ∏è Solo lectura |
| **Roles Dept.** | ‚ùå | ‚ùå | ‚ùå | üîß Su √°rea |
| **Empleado** | ‚ùå | ‚ùå | ‚ùå | ‚ùå M√≠nimo |

---

## Gesti√≥n de Roles

### Crear Super Admin

Solo mediante comando de consola:

```bash
php artisan admin:create-super-admin --email=admin@paucara.com --name="Super Admin"
```

### Asignar M√∫ltiples Roles a Empleados

Los empleados pueden tener m√∫ltiples roles simult√°neamente mediante el sistema de multi-select:

```php
// Ejemplo: Un empleado puede ser Vendedor Y Chofer
$empleado->user->assignRole(['Vendedor', 'Chofer']);
```

### Verificar Permisos

```php
// Verificar si tiene permiso
if (auth()->user()->can('ventas.create')) {
    // Puede crear ventas
}

// Verificar si tiene rol
if (auth()->user()->hasRole('Super Admin')) {
    // Es Super Admin
}

// Verificar cualquiera de varios roles
if (auth()->user()->hasAnyRole(['Admin', 'Manager', 'Super Admin'])) {
    // Tiene rol administrativo
}
```

---

## Regenerar Roles y Permisos

Para actualizar los roles y permisos en la base de datos:

```bash
php artisan db:seed --class=RolesAndPermissionsSeeder
```

‚ö†Ô∏è **IMPORTANTE:** Esto sincronizar√° los permisos de cada rol. Los usuarios existentes mantendr√°n sus roles asignados.

---

## Notas de Seguridad

1. ‚ö†Ô∏è Solo debe haber 1-2 Super Admins en el sistema
2. ‚ö†Ô∏è Los Super Admins NO deben usarse para operaciones diarias
3. ‚úÖ Use el rol Manager para administraci√≥n operativa
4. ‚úÖ Asigne el rol m√≠nimo necesario a cada empleado
5. ‚úÖ Revise peri√≥dicamente los permisos de usuarios
6. ‚úÖ Los empleados pueden tener m√∫ltiples roles para flexibilidad

---

## Fecha de Actualizaci√≥n

**√öltima actualizaci√≥n:** 13 de Octubre, 2025

**Versi√≥n del documento:** 1.0

---

**Desarrollado para:** Distribuidora Paucara
**Framework:** Laravel 11 + Spatie Permission
**Documentaci√≥n:** Claude Code Assistant
